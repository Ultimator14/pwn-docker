#!/usr/bin/python

from pwn import *

# Config
local = True
BINARY = "./mybinary"

chost = "172.17.0.2"
tport = 4100
gport = 4101

rhost = "remotehost"
rport = 0

# Default setup
context.terminal = ["gnome-terminal", "-e"]
context.gdbinit = "~/.gdbinit-gef"
context.binary = BINARY

gdbscript = """
gef config context.nb_lines_stack 20
b main
c
"""

local = True

if local:
    def sh_init():
        # debug
        sh = remote(chost, tport)
        gdb.attach((chost, gport), gdbscript, BINARY)

        # initial gdb outputs
        _ = sh.recvline()  # gdbserver: Error disabling address space randomization: Operation not permitted
        _ = sh.recvline()  # Process ./mybinary created; pid = ...
        _ = sh.recvline()  # Listening on port 4101
        _ = sh.recvline()  # Remote debugging from host 172.17.0.1, port ...

        return sh
else:
    def sh_init():
        sh = remote(rhost, rport)
        return sh

# Exploit
sh = sh_init()

#print(sh.recv())
#print(sh.recvline())
#print(sh.recvuntil("mystr"))

#sh.send("")
#sh.sendline("")

#sh.interactive()

#sh.close()
